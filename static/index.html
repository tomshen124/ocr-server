<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>材料智能预审</title>
    <script>
        // 移动端自动跳转到 H5 入口，可用 ?pc=1 或 localStorage.forcePc=1 跳过
        (function() {
            var ua = navigator.userAgent || '';
            var isMobile = /Android|webOS|iPhone|iPad|iPod|Mobile|BlackBerry|IEMobile|Opera Mini/i.test(ua);
            var params = new URLSearchParams(window.location.search || '');
            var forcePc = params.has('pc') || localStorage.getItem('forcePc') === '1';
            var forceH5 = params.has('h5');
            if (isMobile && !forcePc && !forceH5 && !/h5\.html$/.test(window.location.pathname)) {
                window.location.replace('h5.html' + window.location.search + window.location.hash);
            }
        })();
    </script>
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components.css">
    <link rel="stylesheet" href="css/modals.css">
</head>
<body>
    <!-- 顶部导航 -->
    <header class="header">
        <div class="header-content">
            <h1 class="header-title">材料智能预审</h1>
            <div class="header-right">
                <div class="system-status" id="system-status" style="display: none;">
                    <span class="status-indicator" id="status-indicator">●</span>
                    <span class="status-text" id="status-text">系统正常</span>
                </div>
                <button class="header-btn">进入适老模式</button>
            </div>
        </div>
    </header>

    <!-- 智能预审结果提示 -->
    <div class="result-notice">
        <span class="notice-icon">⚠️</span>
        <span class="notice-text">温馨提示：以下内容为系统根据申报材料自动比对政务服务事项办事指南，申报材料等，仅供参考。</span>
    </div>

    <!-- 主要内容区域 -->
    <div class="main-container">
        <!-- 左侧基本信息和材料列表 -->
        <div class="left-panel">
            <!-- 基本信息 -->
            <div class="basic-info-card">
                <!-- 由BasicInfoComponent渲染 -->
            </div>

            <!-- 审核材料 -->
            <div class="materials-card">
                <div class="materials-header">
                    <h3 class="card-title">审核材料</h3>
                    <div class="action-buttons">
                        <button class="btn btn-outline" id="export-materials">导出材料</button>
                        <button class="btn btn-primary" id="view-basis">审核依据材料</button>
                    </div>
                </div>

                <div class="materials-summary">
                    <span class="summary-text">建议检查要素</span>
                    <span class="summary-count" id="check-count">2项</span>
                </div>

                <div class="materials-list" id="materials-list">
                    <!-- 由MaterialsListComponent渲染 -->
                </div>
            </div>

            <!-- 已通过材料 -->
            <div class="passed-materials-card">
                <!-- 由PassedMaterialsComponent渲染 -->
            </div>

            <!-- 下载按钮 -->
            <div class="download-actions">
                <button class="download-btn" id="download-report-pdf" style="display: none;">
                    下载PDF报告
                </button>
                <button class="download-btn download-btn-secondary" id="download-report-html" style="display: none;">
                    下载HTML报告
                </button>
            </div>
        </div>

        <!-- 右侧内容预览区域 -->
        <div class="right-panel" id="right-panel">
            <!-- 由StatusDisplayComponent或DocumentPreviewComponent渲染 -->
        </div>
    </div>

    <!-- Loading 遮罩层 -->
    <div class="loading-overlay" id="loading-overlay">
        <!-- Loading页面头部 -->
        <div class="loading-header">
            <div class="loading-header-content">
                <h1 class="loading-header-title">材料智能预审</h1>
                <button class="loading-header-btn">进入适老模式</button>
            </div>
        </div>
        
        <!-- Loading主内容区 -->
        <div class="loading-content">
            <div class="loading-scanner">
                <div class="scanner-frame">
                    <div class="scanner-line"></div>
                    <div class="scanner-corners"></div>
                    <div class="document-icon">
                        <div class="doc-line"></div>
                        <div class="doc-line"></div>
                        <div class="doc-line"></div>
                        <div class="doc-line"></div>
                    </div>
                </div>
            </div>
            <div class="loading-progress">
                <div class="progress-text">
                    <span id="progress-percent">80%</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
            </div>
            <p class="loading-text">正在进行智能预审，预计需要等待 <span id="estimated-time">3</span> 分钟</p>
        </div>
    </div>

    <!-- 异常提示弹窗 -->
    <div class="modal-overlay" id="error-modal">
        <div class="modal-content">
            <div class="error-icon">
                <svg width="60" height="60" viewBox="0 0 60 60">
                    <circle cx="30" cy="30" r="25" fill="#e8f4fd" stroke="#4a90e2" stroke-width="2"/>
                    <text x="30" y="38" text-anchor="middle" fill="#4a90e2" font-size="24">?</text>
                </svg>
            </div>
            <h3 class="error-title">智能预审出小差了</h3>
            <p class="error-message">点击"重试"可重新发起智能预审</p>
            <button class="btn btn-primary" id="retry-btn">重试</button>
        </div>
    </div>

    <!-- 文档预览弹窗 -->
    <div class="document-modal" id="document-modal">
        <div class="document-modal-content">
            <div class="document-modal-header">
                <h3 id="document-title">营业执照</h3>
                <button class="close-btn" id="close-document">&times;</button>
            </div>
            <div class="document-modal-body">
                <img id="document-image" src="" alt="文档预览">
            </div>
        </div>
    </div>

    <!-- 脚本引入 -->
    <script src="js/config.js"></script>
    <script src="js/utils.js"></script>
    <script src="js/components.js"></script>
    <script src="js/api.js"></script>
    <script src="js/app.js"></script>
</body>
</html>
